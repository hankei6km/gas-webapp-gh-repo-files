<!DOCTYPE html>
<html>
  <head>
    <title>My Website</title>
  </head>
  <body>
    <h1>Welcome to My Website</h1>
    <p>テスト 11</p>
    <div class="block form-group">
      <textarea class="width-100" id="repo-textarea" rows="1"></textarea>
    </div>
    <div class="block">
      <button class="action" id="run-button" onclick="handleRun()">Run</button>
    </div>
    <div class="block form-group">
      <textarea class="width-100" id="response-textarea" rows="15"></textarea>
    </div>
  </body>
  <script>
    function disableInputs() {
      document.getElementById('repo-textarea').disabled = true
      document.getElementById('run-button').disabled = true
    }
    function enableInputs() {
      document.getElementById('repo-textarea').disabled = false
      document.getElementById('run-button').disabled = false
    }
    function handleRun() {
      disableInputs()
      const repoText = document.getElementById('repo-textarea').value
      new Promise((resolve, reject) => {
        const responseEl = document.getElementById('response-textarea')
        responseEl.value = 'test<br>test'
        google.script.run
          .withSuccessHandler(function (responseText) {
            const responseEl = document.getElementById('response-textarea')
            responseEl.value = JSON.stringify(responseText, null, 2)
            resolve()
          })
          .withFailureHandler(function (error) {
            const responseEl = document.getElementById('response-textarea')
            responseEl.value = error.message
            // reject()
            resolve()
          })
          .repoToFile({ url: repoText })
      }).then(() => {
        enableInputs()
      })
    }
    function handleClear() {
      document.getElementById('repo-textarea').value = ''
      document.getElementById('response-textarea').value = ''
    }
  </script>
</html>
